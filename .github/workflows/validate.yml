name: Validate Dockerfile

on:
    workflow_call:
      secrets:
        DOCKER_USERNAME:
          required: true
        DOCKER_PASSWORD:
          required: true
      
jobs:
    publish:
      name: Publish
      timeout-minutes: 10
      runs-on: ubuntu-latest

      steps:
        - name: Checkout code
          uses: Actions/checkout@v3
          with:
            repository: ${{ github.repository }}
            ref: ${{ github.ref_name }}
            fetch-depth: 0

        - name: Docker login
          env:
            DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
            DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
          run: |
            $(echo ${{env.DOCKER_PASSWORD}}) | docker login -u ${{env.DOCKER_USERNAME}} --password-stdin